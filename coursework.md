<p align="center">Министерство образования, науки и молодежной политики Республики Коми</p>

<p align="center">ГПОУ "Сыктывкарский политехнический техникум"</p>






<p align="center">Курсовая работа</p>



<p align="center">тема: База данных школы детского творчества</p>















<p align="right"> выполнил </p>

<p align="right">студент 4 курса </p>

<p align="right">414 группы </p>

<p align="right">Русанов Дмитрий Юрьевич</p>



<p align="right">проверил</p>

<p align="right">Пунгин И.В.</p>



















# Задание на курсовую работу по МДК 11.01 "Технология разработки и защиты баз данных"

Специальность: <ins> 09.02.07 "Информационные системы и программирование"  </ins>

Тема курсовой работы:База данных школы детского творчества

Срок представления работы к защите: <ins> ?? марта 2025 года. </ins>

Перечень подлежащих разработке вопросов:

1. Анализ предметной области. Постановка задачи.

    1.1. Описание предметной области и функции решаемых задач.

    1.2. Перечень входных данных.

    1.3. Перечень выходных данных

    1.4. Ограничения предметной области (если таковые имеются).

    1.5. Взаимодействие с другими программами.

3. Инфологическая (концептуальная) модель базы данных.

    2.1. Выделение информационных объектов.

    2.2. Определение атрибутов объектов.

    2.3. Определение отношений и мощности отношений между объектами.

    2.4. Построение концептуальной модели.

4. Логическая структура БД.

5. Физическая структура базы данных.

6. Реализация проекта в среде конкретной СУБД.

    6.1. Создание таблиц и индексов.

    6.2. Создание представлений и функций.

    5.3. Разработка интерфейса.

    5.4. Назначение прав доступа.

    5.5. Разработка стратегии резервного копирования базы данных.

    







## <a id="content">Содержание</a>

1. [Введение](#introduction)
    - [Цель работы](#target)
    - [Задачи работы](#tasks)
2. [Основная часть](#main)
    - [Анализ предметной области. Постановка задачи](#analysis)
    - [Инфологическая (концептуальная) модель базы данных](#infological_model)
    - [Логическая структура БД](#logical_structure)
    - [Физическая структура базы данных](#physical_structure)
    - [Реализация проекта в среде конкретной СУБД](#project_realization)
3. [Заключение](#conclusion)
4. [Список использованных информационных источников](#literature)
5. [Приложения](#applications)



## <a id="introduction">Введение</a>
# Курсовая работа: База данных для школы детского творчества
**Разработка системы управления кружками и конкурсами**

В условиях современного дополнительного образования эффективный учет деятельности творческих объединений, мероприятий и достижений учащихся является ключевым фактором успешной работы школы детского творчества. Управление информацией о кружках, конкурсах, участниках и педагогах требует систематизации данных, оперативного доступа к ним и минимизации рутинных операций, что обуславливает актуальность разработки специализированной базы данных (БД). Такая система должна предоставлять структурированный доступ к информации о творческих группах, мероприятиях, педагогах и их воспитанниках, обеспечивая прозрачность процессов для администраторов, преподавателей и родителей.

Внедрение автоматизированной базы данных позволит оптимизировать процессы учета, сократить время на формирование отчетов, отслеживать динамику участия в конкурсах и анализировать результаты работы педагогов. Основной задачей проекта является создание удобного инструмента для регистрации событий (конкурсов, выставок), управления группами учащихся, а также формирования аналитических отчетов. Система должна поддерживать разграничение прав доступа, интеграцию с веб-интерфейсом на PHP и обеспечение целостности данных.

Реализация данной базы данных создаст надежный фундамент для автоматизации работы школы детского творчества, что способствует повышению качества образовательных услуг, объективной оценке достижений учащихся и эффективному планированию мероприятий.

#### <a id="target">Цель работы</a>

Цель работы заключается в разработке базы данных для школы детского творчества, которая обеспечит централизованное управление информацией о творческих группах, мероприятиях, педагогах и учащихся. В рамках работы предполагается:

1. **Автоматизация учёта деятельности**:
        Учет участия учащихся в конкурсах и выставках.
        Фиксация результатов мероприятий (победители, номинации).
        Управление расписанием работы творческих объединений.
2. **Проектирование структуры БД**:
        Определение сущностей: группы, педагоги, учащиеся, конкурсы, мероприятия.
        Установление связей между таблицами (например, привязка учащихся к группам, педагогов к мероприятиям).
3. **Реализация функционала**:
        Разработка веб-интерфейса на PHP для взаимодействия с данными.
        Создание форм для добавления новых мероприятий, регистрации участников, формирования отчетов.
4. **Обеспечение безопасности**:
        Внедрение ролевой модели (администратор, педагог, учащийся).
        Шифрование персональных данных (контакты родителей, логины и пароли).
5. **Аналитическая поддержка**:
        Формирование отчетов по активности групп, результативности педагогов, участию в мероприятиях.


#### <a id="tasks">Задачи работы</a>  

Для достижения поставленной цели необходимо решить следующие задачи:

1. **Провести анализ предметной области**:
    - Изучить процессы работы школы детского творчества: формирование групп, проведение конкурсов, учет достижений.
    - Выявить ключевые данные для хранения: информация о группах, педагогах, учащихся, мероприятиях, результатах участия.

2. **Спроектировать логическую и физическую структуру БД**:
    - Определить таблицы: groups (творческие объединения), students (учащиеся), teachers (педагоги), contests (мероприятия), student_contests (связь учащихся с мероприятиями).
    - Установить ограничения целостности (например, запрет удаления группы с активными учащимися).

3. **Реализовать базу данных в PostgreSQL**:
    - Написать SQL-скрипты для создания таблиц, индексов и триггеров (например, автоматическое обновление количества участников в группе).
    - Реализовать представления для формирования отчетов: «Топ педагогов по количеству побед», «Активность групп за год».

4. **Разработать веб-интерфейс на PHP**:
    - Создать страницы для администратора (управление группами, мероприятиями), педагога (ввод результатов конкурсов), учащегося (просмотр своих достижений).
    - Интегрировать авторизацию через таблицу users с ролями.

5. **Обеспечить безопасность данных**:
    - Настроить резервное копирование с использованием pg_dump.
    - Реализовать хеширование паролей (алгоритм bcrypt).

6. **Заполнить БД тестовыми данными и провести тестирование**:
    - Проверить корректность связей (например, участие ученика в конкурсе только через свою группу).
    - Убедиться в работе ограничений (например, уникальность логинов в таблице users).


#### <a id="analysis">Анализ предметной области. Постановка задачи</a>

1. **Описание предметной области и функции решаемых задач**
        - **Предметная область данной работы** - управление информацией о студентах, преподавателях, группах и конкурсах в центре детского творчества. Система направлена на автоматизацию процессов учета и обработки данных, что позволит администраторам и преподавателям эффективно отслеживать достижения учащихся, анализировать их результаты и вносить изменения. Основной целью автоматизации является упрощение работы с данными, надежное их хранение, повышение прозрачности образовательного процесса и улучшение качества предоставляемых услуг.
        - **Функции решаемых задач**:
            - **Хранение информации о группах**: Ведение базы данных, содержащей информацию о каждой группе (название, преподаватель, список студентов). Это позволит администраторам легко управлять данными о группах и отслеживать их изменения.
            - **Организация мероприятий**: Регистрация конкурсов, выставок и других событий с указанием даты, описания, ответственного педагога и победителей.
            - **Учет студентов**: Сохранение данных о каждом студенте, включая имя, фамилию, отчество, дату рождения и группу. Это обеспечит возможность быстрого доступа к информации о каждом учащемся.
            - **Обеспечение доступа к информации**: Создание интуитивно понятного интерфейса, который позволит преподавателям и администраторам легко находить нужные данные о группах, студентах.


2. **Перечень входных данных.** Для эффективной работы системы необходимы следующие входные данные:
    - **Данные о группах**:
        - Идентификатор группы (ID).
        - Название группы.
        - Год начала обучения.
        - Количество учеников.
    - **Данные о преподавателях**:
        - Идентификатор преподавателя (ID).
        - Имя, фамилия и отчество преподавателя.
        - Руководитель группы. (ID Группы)
        - Нопер и почта.
    - **Данные о ученика**:
        - Идентификатор ученика (ID).
        - Имя, фамилия и отчество ученика.
        - Дата рождения.
        - Группа, к которой принадлежит ученика. (ID Группы)
        - Место жительства.
        - Контакты родителей.
    - **Данные о конурсах**:
        - Идентификатор конкурса (ID).
        - Название конкурса.
        - Дата проведения.
        - Описание конкурса.
        - Задание конкурса.
        - Победитель конкурса. (ID Ученика)
        - Организатор конкурса. (ID Учителя)
    - **Данные о пользователей**:
        - Идентификатор пользователя (ID).
        - Логин пользователея
        - Пароль пользователея
        - Роль пользователея.
        - Идентификатор ученика. (ID Ученика)
        - Идентификатор преподавателя. (ID Ученика)
    - **Данные записей на конкурсы**
        - Идентификатор ученика (ID Ученика).
        - Идентификатор конкурса (ID Конкурса).

3. **Перечень выходных данных.** Система должна формировать следующие виды выходных данных:
    - **Отчеты по конкурсам**:
        - Список всех конкурсов с их описанием и датами проведения.
        - Участники конкурсов (студенты, участвующие в каждом конкурсе).
        - Результаты конкурсов (оценки и награды, полученные участниками).

    - **Отчеты по группам**:
        - Список групп с указанием преподавателей и студентов.
        - Информация о текущих и прошедших конкурсах для каждой группы.
        - Статистика успеваемости студентов в группах (средние оценки по предметам).

    - **Отчеты по студентам (для учителей и учеников)**:
        - Список студентов в группе с их контактными данными.
        - История оценок студентов по предметам.
        - Участие студентов в конкурсах и результаты.

    - **Отчеты по преподавателям (для администраторов)**:
        - Список всех преподавателей с указанием предметов и групп, которые они ведут.
        - История работы преподавателей (количество проведенных уроков, участие в конкурсах).

    - **Отчеты по администраторам**:
        - Список всех администраторов с их ролями и правами доступа.
        - История изменений в базе данных (добавление/изменение/удаление записей).

4. **Ограничения предметной области.** При работе с базой данных могут возникнуть следующие ограничения:
    - **Ограничение по объему данных**: Увеличение количества студентов, групп и оценок может негативно сказаться на производительности системы. Необходимо учитывать возможность оптимизации базы данных, включая использование индексации и других методов для повышения скорости обработки запросов.
    - **Ограничение по обновлению данных**: Для предотвращения потери данных необходимо разработать систему резервного копирования. Регулярные бэкапы помогут избежать потерь информации в случае технических сбоев или ошибок пользователей.

5. **Взаимодействие с другими программами**. Система управления информацией о студентах может взаимодействовать с различными образовательными и административными системами для расширения функциональности:
    - **Веб-интерфейс на PHP**: Используется для взаимодействия пользователей с БД через браузер. Реализована авторизация через таблицу users с ролями.
    - **Система управления учебным процессом**: Интеграция с существующими системами управления учебным процессом позволит автоматизировать обмен данными о расписании уроков, группах и преподавателях, а также синхронизировать информацию о конкурсах и мероприятиях.
    - **Портал для родителей**: Создание веб-портала, где родители смогут отслеживать успеваемость своих детей, получать уведомления о новых оценках и конкурсах, а также взаимодействовать с преподавателями. Это повысит вовлеченность родителей в образовательный процесс.
    - **Система аналитики**: Интеграция с аналитическими платформами (например, Power BI или Google Data Studio) для визуализации данных и создания отчетов. Это поможет в анализе успеваемости студентов, выявлении проблемных областей и оценке эффективности преподавания.
    - **Электронная почта**: Автоматическая отправка уведомлений о новых конкурсах, изменениях в расписании, а также о результатах оценивания. Это позволит держать студентов и преподавателей в курсе актуальной информации.
    - **Система управления мероприятиями**: Интеграция с платформами для управления мероприятиями, что позволит организовывать конкурсы и другие события, отслеживать регистрацию участников и управлять логистикой.

#### <a id="infological_model">Инфологическая (концептуальная) модель базы данных</a>
### 1. **Выделение информационных объектов**
- **Группы (Groups)**:
    Коллективы учеников, объединённые по направлениям (художественные, музыкальные и др.). Указывают год создания и количество участников.
- **Ученики (Students)**:
    Основная сущность, хранящая данные о детях, посещающих школу творчества: ФИО, дата рождения, контакты родителей, принадлежность к группе.
- **Преподаватели (Teachers)**:
    Сотрудники школы, организующие занятия и мероприятия. Содержат информацию о ФИО, контактных данных и прикреплённых группах.
- **Конкурсы (Contests)**:
    Мероприятия, проводимые школой: выставки, фестивали, соревнования. Фиксируют название, дату, описание и ответственного преподавателя.
- **Участие в конкурсах (Student_Contests)**:
    Промежуточная сущность для учёта связи между учениками и конкурсами.
- **Пользователи (Users)**:
    Учётные записи для авторизации в системе с ролями: администратор, преподаватель, ученик.

### 2. Определение атрибутов объектов
1. **Группы (Groups)**:
    - `id_group` — уникальный идентификатор группы.
    - `group_name` — название группы (например, "Театральная студия").
    - `study_year_start` — год формирования группы.
    - `students_amount` — текущее количество участников.
2. **Учащиеся (Students)**:
    - `id_student` — уникальный идентификатор учащегося.
    - `name`, `surname`, `lastname` — ФИО учащегося.
    - `birthdate` — дата рождения.
    - `live_place` — адрес проживания.
    - `parent_contact` — контактные данные родителей.
    - `group_id` — идентификатор группы, в которой состоит учащийся.
3. **Педагоги (Teachers)**:
    - `id_prep` — уникальный идентификатор педагога.
    - `name`, `surname`, `lastname` — ФИО педагога.
    - `phone_num`, `email` — контактные данные.
    - `group_id` — идентификатор группы, которой руководит педагог (опционально).
4. **Мероприятия (Contests)**:
    - `id_contest` — уникальный идентификатор мероприятия.
    - `title` — название мероприятия (например, "Конкурс юных художников").
    - `date` — дата проведения.
    - `description` — описание мероприятия.
    - `subject` — направленность (танцы, живопись, музыка).
    - `teacher_id` — идентификатор педагога-организатора.
    - `winning_student` — идентификатор победителя (если есть).
5. **Участие в мероприятиях (Student_Contests)**:
    - `student_id` — идентификатор учащегося.
    - `contest_id` — идентификатор мероприятия.
6. **Пользователи (Users)**:
    - `id_user` — уникальный идентификатор пользователя.
    - `username` — логин для входа.
    - `password` — хеш пароля.
    - `role` — роль (admin, teacher, student).
    - `student_id` / `teacher_id` — связь с учётной записью учащегося или педагога.

### 3. Определение отношений и мощности связей
- **Группа ↔ Ученики**:
    Тип связи: Один ко многим (`1:N`).

    Описание: Одна группа может включать множество учащихся, но каждый учащийся принадлежит только одной группе.

    Реализация: Внешний ключ `group_id` в таблице `students`.

- **Преподаватель ↔ Группа**
    Тип связи: Один к одному (`1:1`) или один ко многим (`1:N`).

    Описание: Педагог может руководить одной или несколькими группами (в зависимости от политики школы).

    Реализация: Внешний ключ `group_id` в таблице `teachers`.

- **Преподаватель ↔ Конкурсы**:
    Тип связи: Один ко многим (`1:N`).

    Описание: Преподаватель может организовать несколько мероприятий, но каждое мероприятие курирует только один педагог.

    Реализация: Внешний ключ `teacher_id` в таблице `contests`.

- **Ученики ↔ Конкурсы**:
    Тип связи: Многие ко многим (`M:N`).

    Описание: Учащийся может участвовать в нескольких мероприятиях, а мероприятие может включать множество участников.

    Реализация: Связующая таблица `student_contests` с полями `student_id` и `contest_id`.

- **Пользователь ↔ Ученик/Преподаватель**:
    Тип связи: Один к одному (`1:1`).

    Описание: Каждый пользователь (роль student или teacher) привязан к одной учетной записи учащегося или педагога.

    Реализация: Внешние ключи `student_id` и `teacher_id` в таблице `Users`.

### 4. Построение концептуальной модели

Концептуальная модель базы данных представлена в виде ER-диаграммы, отражающей сущности, их атрибуты и связи:

`!!!!! Здесь добавить ER-диаграмма !!!!!!`

**Пояснения к модели**:
    Группы (Groups) — центральная сущность, связанная с учащимися и педагогами.
    Связь M:N между Students и Contests реализована через таблицу Student_Contests.
    Ролевая модель (Users) обеспечивает разграничение прав доступа через привязку к Students или Teachers.
    Поле winning_student в Contests позволяет фиксировать победителей мероприятий.

Эта модель обеспечивает целостность данных, гибкость для расширения функционала и соответствует требованиям школы детского творчества.

#### <a id="logical_structure">Логическая структура БД</a>


### **Определение таблиц и их атрибутов**  

#### 1. **Таблица `students` (Ученики)**
| Атрибут           | Тип данных       | Описание                          | Ограничения                     |  
|--------------------|------------------|-----------------------------------|---------------------------------|  
| `id_student`       | SERIAL          | Уникальный идентификатор ученика | PRIMARY KEY                     |  
| `name`             | VARCHAR(100)    | Имя ученика                      | NOT NULL                        |  
| `surname`          | VARCHAR(100)    | Фамилия ученика                  | NOT NULL                        |
| `lastname`         | VARCHAR(100)    | Отчество ученика                 | NOT NULL                        |
| `group_id`         | INTEGER         | Идентификатор группы             | FOREIGN KEY (group_id) REFERENCES groups  |  
| `birthdate`        | DATE            | Дата рождения                    | NOT NULL                        |  
| `parent_contact`   | VARCHAR(50)     | Контакт родителя                 |                                 |
---

#### 2. **Таблица `teachers` (Преподаватели)**
| Атрибут           | Тип данных       | Описание                          | Ограничения                     |  
|--------------------|------------------|-----------------------------------|---------------------------------|  
| `id_teacher`       | SERIAL          | Уникальный идентификатор преподавателя| PRIMARY KEY                     |  
| `name`             | VARCHAR(100)    | Имя преподавателя                | NOT NULL                        |  
| `surname`          | VARCHAR(100)    | Фамилия преподавателя            | NOT NULL                        |
| `lastname`         | VARCHAR(100)    | Отчество преподавателя           | NOT NULL                        |  
| `group_id`         | INTEGER         | Идентификатор группы             | FOREIGN KEY (group_id) REFERENCES groups  |  
| `phone`            | VARCHAR(20)     | Контактный телефон               |                                 |  
| `email`            | VARCHAR(255)    | Электронная почта                | UNIQUE                          |  
---

#### 3. **Таблица `groups` (Группы)**
| Атрибут           | Тип данных       | Описание                          | Ограничения                     |  
|--------------------|------------------|-----------------------------------|---------------------------------|  
| `id_group`         | SERIAL          | Уникальный идентификатор группы  | PRIMARY KEY                     |  
| `group_name`       | VARCHAR(100)    | Название группы                  | NOT NULL                        |  
| `study_year_start` | INTEGER         | Фамилия преподавателя            | NOT NULL                        |
| `students_amount`  | INTEGER         | Количество участников            | CHECK (students_amount >= 0)    |  
---

#### 4. **Таблица `contests` (Конкурсы)**
| Атрибут           | Тип данных       | Описание                          | Ограничения                     |  
|--------------------|------------------|-----------------------------------|---------------------------------|  
| `id_contest`       | SERIAL          | Уникальный идентификатор конкурса| PRIMARY KEY                     |  
| `title`            | VARCHAR(255)    | Название конкурса                | NOT NULL                        |  
| `date`             | DATE            | Дата проведения                  | NOT NULL                        |
| `description`      | TEXT            | Описание мероприятия             |                                 |  
| `subject`          | TEXT            | Задание мероприятия              |                                 |  
| `teacher_id`       | INTEGER         | Ответственный преподаватель      | FOREIGN KEY (teacher_id) REFERENCES teachers  |  
---

#### 5. **Таблица `student_contests` (Участие в конкурсах)**
| Атрибут           | Тип данных       | Описание                          | Ограничения                     |  
|--------------------|------------------|-----------------------------------|---------------------------------|  
| `student_id`       | INTEGER          | Идентификатор ученика             | PRIMARY KEY, FOREIGN KEY (student_id) REFERENCES students |  
| `contest_id`       | INTEGER          | Идентификатор конкурса            | PRIMARY KEY, FOREIGN KEY (contest_id) REFERENCES contests |  
---

#### 6. **Таблица `users` (Пользователи)**
| Атрибут           | Тип данных       | Описание                          | Ограничения                     |  
|--------------------|------------------|-----------------------------------|---------------------------------|  
| `user_id`           | SERIAL          | Уникальный идентификатор пользователя| PRIMARY KEY                     |  
| `username`          | VARCHAR(50)     | Логин                            | UNIQUE                        |  
| `password`          | DATE            | Пароль                           | NOT NULL                        |
| `role`              | TEXT            | Роль (admin, teacher, student)   | HECK (role IN ('admin', 'teacher', 'student'))  |  
| `student_id`        | TEXT            | Связь с учеником                 | FOREIGN KEY (student_id) REFERENCES students  |  
| `teacher_id`        | INTEGER         | Связь с преподавателем           | FOREIGN KEY (teacher_id) REFERENCES teachers  |  
---

### **Связи между таблицами**
1. **Группы ↔ Ученики**
    - Одна группа (`groups`) может включать множество учеников (`students`).
    - Связь: `1:N` через `group_id` в таблице `students`.

2. **Преподаватели ↔ Конкурсы**
    - Один преподаватель (teachers) организует несколько конкурсов (contests).
    - Связь: 1:N через teacher_id в таблице contests.

3. **Ученики ↔ Конкурсы**
    - Ученик может участвовать в нескольких конкурсах, а конкурс включает несколько учеников.
    - Связь: M:N через промежуточную таблицу student_contests.

4. **Пользователи ↔ Ученики/Преподаватели**
    - Пользователь с ролью "ученик" привязан к одному ученику, а с ролью "преподаватель" — к одному преподавателю.
    - Связь: 1:1 через student_id или teacher_id в таблице users.

---

### **Пример SQL-запроса для создания таблицы `contests`**
```sql
CREATE TABLE contests (
    id_contest SERIAL PRIMARY KEY,  
    title VARCHAR(255) NOT NULL,  
    date DATE NOT NULL,  
    description TEXT,
    subject VARCHAR(255) NOT NULL,
	winning_student INTEGER NULL,  
    teacher_id INTEGER REFERENCES teachers(id_prep)  
);  
```

Эта структура обеспечивает целостность данных, производительность и соответствие требованиям учёта мероприятий школы детского творчества.


#### <a id="physical_structure">Физическая структура базы данных</a>

Физическая структура базы данных определяет способы хранения данных на уровне СУБД (PostgreSQL) с учетом производительности, целостности и безопасности.
Ниже приведено детальное описание реализации таблиц, индексов, триггеров и других элементов.

### **1. Типы данных и ограничения**

Таблица `groups`:
```sql

CREATE TABLE Groups (
    id_group SERIAL PRIMARY KEY,
    group_name VARCHAR(100) NOT NULL,
    study_year_start INT NOT NULL,
    students_amount INT DEFAULT 0 
);
```
- **Типы данных**:
    SERIAL для автоинкрементного идентификатора.
    VARCHAR(100) для названия группы.
    INT для года формирования и количества участников.

Таблица `students`:
```sql

CREATE TABLE Students (
    id_student SERIAL PRIMARY KEY CHECK (((id_student > 10000) AND (id_student <= 10000000))),
    name VARCHAR(50) NOT NULL,
    surname VARCHAR(50) NOT NULL,
    lastname VARCHAR(50) NOT NULL,
    birthdate DATE NOT NULL,
    live_place VARCHAR(255) NULL,
    parent_contact VARCHAR(20) NULL,
    group_id INT NOT NULL,
    FOREIGN KEY (group_id) REFERENCES Groups(id_group)
);
```
- **Типы данных**:
    DATE для даты рождения.
    VARCHAR(20) для контакта родителя (формат: +7 (XXX) XXX-XX-XX).

- **Ограничения**:
    CHECK для индифекатора ученика в пределах от 10001 до 10000000.

Таблица `teachers`:
```sql

CREATE TABLE Teachers (
    id_prep SERIAL PRIMARY KEY (((id_prep >= 1) AND (id_prep <= 10000))),
    name VARCHAR(50) NOT NULL,
    surname VARCHAR(50) NOT NULL,
    lastname VARCHAR(50) NOT NULL,
    phone_num VARCHAR(20) NOT NULL,
    email VARCHAR(255) NOT NULL,
    group_id INT NULL,
    FOREIGN KEY (group_id) REFERENCES Groups(id_group) 
);
```
- **Ограничения**:
    CHECK для индифекатора учителя в пределах от 1 до 10000.

Таблица `сontests`:
```sql

CREATE TABLE Contests (
    id_contest SERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    date DATE NOT NULL,
    description TEXT NOT NULL,
    subject VARCHAR(50) NOT NULL,
    teacher_id INT NOT NULL,
    winning_student INT NULL,
    FOREIGN KEY (teacher_id) REFERENCES Teachers(id_prep),
    FOREIGN KEY (winning_student) REFERENCES Students(id_student)
);
```

- **Типы данных**:
    TEXT для длинных описаний мероприятий.

Таблица `student_contests`:
```sql

CREATE TABLE Student_Contests (
    student_id INT NOT NULL,
    contest_id INT NOT NULL,
    PRIMARY KEY (student_id, contest_id),
    FOREIGN KEY (student_id) REFERENCES Students(id_student),
    FOREIGN KEY (contest_id) REFERENCES Contests(id_contest)
);
```

Таблица `users`:
```sql

CREATE TABLE Users (
    id_user SERIAL PRIMARY KEY,
    username VARCHAR(50) NOT NULL,
    password VARCHAR(255) NOT NULL,
    role VARCHAR(20) NOT NULL CHECK (role IN ('admin', 'teacher', 'student')),
    student_id INT NULL,
    teacher_id INT NULL,
    FOREIGN KEY (student_id) REFERENCES Students(id_student),
    FOREIGN KEY (teacher_id) REFERENCES Teachers(id_prep)
);
```
- **Ограничения**:
    CHECK для ролей.
---

### **2. Стратегия резервного копирования**
- Ежедневные логические бэкапы:
```bash
    pg_dump -U admin -d postgres -F c -b -v -f /backups/creative_school_$(date +\%Y\%m\%d).backup
```
- Еженедельные физические бэкапы:
```bash
    pg_basebackup -U admin -D /backups/basebackup -Ft -z -P
```
- Восстановление из бэкапа:
```bash
    pg_restore -U admin -d creative_school /backups/creative_school_20231001.backup
```
---

### **3. Настройки производительности PostgreSQL**
- **Конфигурация `postgresql.conf`**:
```ini
    shared_buffers = 2GB           # 25% от доступной RAM
    work_mem = 32MB                # Для сортировки и агрегации
    maintenance_work_mem = 1GB     # Для индексации и VACUUM
    max_connections = 200          # Поддержка многопользовательской работы
```
- **Партиционирование таблицы `contests`**:
```sql
    CREATE TABLE Contests_2023 PARTITION OF Contests
    FOR VALUES FROM ('2023-01-01') TO ('2024-01-01');
```
---

### **4. Интеграция с PHP-интерфейсом**
- **Пример подключения к БД**:
```php
<?php
$host = "localhost";
$dbname = "creative_school";
$user = "admin";
$password = "secure_password";

try {
    $pdo = new PDO("pgsql:host=$host;dbname=$dbname", $user, $password);
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
} catch (PDOException $e) {
    die("Ошибка подключения: " . $e->getMessage());
}
?>
```
---
- **Пример запроса для получения списка мероприятий:**
```php
$stmt = $pdo->query("
    SELECT c.title, c.date, t.surname AS teacher 
    FROM Contests c 
    JOIN Teachers t ON c.teacher_id = t.id_prep 
    ORDER BY c.date DESC
");
$contests = $stmt->fetchAll(PDO::FETCH_ASSOC);
```
---

### **5. Дополнительные меры безопасности**
- **Шифрование паролей:**
    Пароли в таблице Users хранятся в виде хешей с использованием bcrypt.
    Пример хеширования в PHP:
```php
    $password_hash = password_hash($_POST['password'], PASSWORD_BCRYPT);
```
- ***Ограничение прав доступа:**
        Администраторы: полный доступ через PHP-интерфейс.
        Педагоги: редактирование мероприятий и групп.
        Учащиеся: только просмотр своих данных.
---
### **6. Примеры запросов**
- **Запрос для получения активности групп:**
```sql
SELECT 
    g.group_name, 
    COUNT(sc.contest_id) AS total_contests,
    COUNT(c.winning_student) AS total_wins
FROM Groups g
LEFT JOIN Students s ON g.id_group = s.group_id
LEFT JOIN Student_Contests sc ON s.id_student = sc.student_id
LEFT JOIN Contests c ON sc.contest_id = c.id_contest
GROUP BY g.group_name;
```
---
- **Запрос для поиска педагогов по email:**
```sql
Copy

SELECT name, surname, phone_num 
FROM Teachers 
WHERE email ILIKE '%art@example.com%';
```
---

#### <a id="project_realization">Реализация проекта в среде конкретной СУБД</a>

1. **Создание таблиц**

- **Полный SQL-код для создания таблиц в PostgreSQL с комментариями:**
```sql

-- Группы 
CREATE TABLE Groups (
    id_group SERIAL PRIMARY KEY,
    group_name VARCHAR(100) NOT NULL,
    study_year_start INT NOT NULL,
    students_amount INT DEFAULT 0 
);

-- Ученики
CREATE TABLE Students (
    id_student SERIAL PRIMARY KEY CHECK (((id_student > 10000) AND (id_student <= 10000000))),
    name VARCHAR(50) NOT NULL,
    surname VARCHAR(50) NOT NULL,
    lastname VARCHAR(50) NOT NULL,
    birthdate DATE NOT NULL,
    live_place VARCHAR(255) NULL,
    parent_contact VARCHAR(20) NULL,
    group_id INT NOT NULL REFERENCES Groups(id_group)
);

-- Учителя
CREATE TABLE Teachers (
    id_prep SERIAL PRIMARY KEY (((id_prep >= 1) AND (id_prep <= 10000))),
    name VARCHAR(50) NOT NULL,
    surname VARCHAR(50) NOT NULL,
    lastname VARCHAR(50) NOT NULL,
    phone_num VARCHAR(20) NOT NULL,
    email VARCHAR(255) NOT NULL,
    group_id INT NULL REFERENCES Groups(id_group)
);

-- Кокурсы
CREATE TABLE Contests (
    id_contest SERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    date DATE NOT NULL,
    description TEXT NOT NULL,
    subject VARCHAR(50) NOT NULL,
    teacher_id INT NOT NULL REFERENCES Teachers(id_prep),
    winning_student INT NULL REFERENCES Students(id_student)
);

-- Участие в кокурсах (связь M:N)
CREATE TABLE Student_Contests (
    student_id INT NOT NULL REFERENCES Students(id_student),
    contest_id INT NOT NULL REFERENCES Contests(id_contest),
    PRIMARY KEY (student_id, contest_id)
);

-- Пользователи системы
CREATE TABLE Users (
    id_user SERIAL PRIMARY KEY,
    username VARCHAR(50) NOT NULL,
    password VARCHAR(255) NOT NULL,
    role VARCHAR(20) NOT NULL CHECK (role IN ('admin', 'teacher', 'student')),
    student_id INT REFERENCES Students(id_student) ON DELETE CASCADE,
    teacher_id INT REFERENCES Teachers(id_prep) ON DELETE CASCADE
);
```
2. **Создание запросов**

- **Примеры типовых запросов**:
- **Добавление нового мероприятия**:
    ```sql
    INSERT INTO Contests (title, date, description, subject, teacher_id)
    VALUES ('Конкурс юных поэтов', '2025-05-20', 'Школьный конкурс стихов', 'Литература', 3);
    ```

- **Регистрация участия ученика в мероприятии**:
    ```sql
    INSERT INTO Student_Contests (student_id, contest_id)
    VALUES (10015, 5);
    ```

- **Обновление победителя конкурса**:
    ```sql
    UPDATE Contests
    SET winning_student = 10025
    WHERE id_contest = 5;
    ```

- **Получение списка мероприятий с количеством участников**:
    ```sql
    SELECT c.title, COUNT(sc.student_id) AS participants
    FROM Contests c
    LEFT JOIN Student_Contests sc ON c.id_contest = sc.contest_id
    GROUP BY c.title;
    ```

- **Поиск учеников по группе**:
    ```sql
    SELECT name, surname, birthdate
    FROM Students
    WHERE group_id = 3;
    ```

3. **Разработка интерфейса на PHP**
- **Страница авторизации (login.php)**:
    ```php

    <?php
        session_start();
        require 'db.php'; // Подключаем БД

        if ($_SERVER["REQUEST_METHOD"] == "POST") {
            $username = $_POST['username'];
            $password = $_POST['password'];

            $stmt = $conn->prepare("SELECT id_user, username, password, role, teacher_id, student_id
                                    FROM public.users 
                                    WHERE username = :username");
            $stmt->execute(['username' => $username]);
            $user = $stmt->fetch(PDO::FETCH_ASSOC);

            if ($user && password_verify($password, $user['password'])) {
                $_SESSION['id_user'] = $user['id_user'];
                $_SESSION['username'] = $user['username'];
                $_SESSION['role'] = $user['role'];
                $_SESSION['teacher_id'] = $user['teacher_id'];
                $_SESSION['student_id'] = $user['student_id'];
                header("Location: index.php");
                
            } else {
                $error = "Неверный логин или пароль";
            }
        }
    ?>

<!DOCTYPE html>
<html lang="ru">
    <head>
    <meta charset="UTF-8">
    <title>Вход</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
    <div class="container-fluid p-4">
        <h2>Вход в систему</h2>
        <?php if (isset($error)): ?>
            <div class="alert alert-danger"><?php echo $error; ?></div>
        <?php endif; ?>
        <form method="POST">
            <div class="form-group">
                <label>Логин</label>
                <input type="text" name="username" class="form-control" required>
            </div>
            <div class="form-group">
                <label>Пароль</label>
                <input type="password" name="password" class="form-control" required>
            </div>
            <button type="submit" class="btn btn-secondary">Войти</button>
        </form>
    </div>
</body>
</html>
```

- **Боковая выдвижная панель с настроенным функционалом под роль пользователя**:

```php
<?php
require 'db.php';
$role = $_SESSION['role'];
$username = $_SESSION['username']; 
$teacherId = $_SESSION['teacher_id'];
$studentId = $_SESSION['student_id'];

$sidequery = "SELECT g.group_name, t.group_id 
FROM public.teachers t
left join groups g on t.group_id = g.id_group
where id_prep = :teacher_id";
$sidestmt = $conn->prepare($sidequery);
$sidestmt->execute(['teacher_id' => $teacherId]);
$sideresults = $sidestmt->fetchAll(PDO::FETCH_ASSOC);
$sidequery2 = "SELECT g.group_name, s.group_id 
FROM public.students s
left join groups g on s.group_id = g.id_group
where id_student = :student_id";
$sidestmt2 = $conn->prepare($sidequery2);
$sidestmt2->execute(['student_id' => $studentId]);
$sideresults2 = $sidestmt2->fetchAll(PDO::FETCH_ASSOC);
?>

<head>
    <script src="../sidebar.js"></script>
</head>
<body>
<div class="col p-3" style="position: fixed; display: flex; left:-380px; z-index: 4; background-color: white; width:380px; height:100%; transition: left 0.3s" id="menu">
        <div class="col" style="height:100%">
            <h2>Меню</h2>
            <a href="contest/list.php" class="btn">Конкурсы</a>  
            <br> 
            <?php if ($role === 'admin'): ?>
                <a href="teacher/list.php" class="btn">Учителя</a>
                <br>
                <a href="student/list.php" class="btn">Ученики</a>
                <br>
                <a href="group/list.php" class="btn">Группы</a>
                <br>
                <a href="user/list.php" class="btn">Пользователи</a>
                <br>
                <a href="constud/list.php" class="btn">Записавшиеся Ученики</a>        
            <?php elseif($role === 'teacher'): ?>
                <a class="btn" style="pointer-events: none">Группы</a>
                <br>
                <?php foreach ($sideresults as $siderow): ?>
                    <a href="group.php?group_id=<?php echo $siderow['group_id']; ?>" class="btn mx-3"><?php echo htmlspecialchars($siderow['group_name']); ?></a>
                    <br> 
                <?php endforeach; ?>
            <?php elseif($role === 'student'): ?>
                <?php foreach ($sideresults2 as $siderow): ?>
                    <a href="group.php?group_id=<?php echo $siderow['group_id']; ?>" class="btn"><?php echo htmlspecialchars($siderow['group_name']); ?></a>
                    <br> 
                <?php endforeach; ?>
            <?php endif;?>
        </div>
        <div class="col" style="position: absolute; align-self: end; align-content: end;">
            <div clas="row"><?php echo $username;?> | <?php echo $role;?> <a href="logout.php" class="btn" style="align-self: end;">Выход</a> </div >
        </div> 
</div> 
<div id="overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); visibility: hidden; z-index: 3; transition: opacity 0.3s, visibility 0.3s;"></div>
</body>
```

- **Форма добавления данных в базу данных(для каждой таблицы свой файл, но по синтаксису они все похожи)**:

```php
    <?php
session_start();
require '../db.php';
// require 'sidebar.php';

if (!isset($_SESSION['id_user'])) {
    header("Location: ../login.php");
    exit();
}
$role = $_SESSION['role'];
if ($role !== 'admin' && $role !== 'teacher') {
    header("Location: ../index.php");
    exit();
}
try {
    $pdo = new PDO("pgsql:host=$host;dbname=$dbname", $username, $password);
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
} catch (PDOException $e) {
    $_SESSION['error_message'] = "Не удалось подключиться к базе данных: " . $e->getMessage();
    header("Location: list.php");
    exit();
}


if ($_SERVER["REQUEST_METHOD"] == "POST") {
    $id_contest = $_POST['id_contest'];
    $title = $_POST['title'];
    $date = $_POST['date'];
    $description = $_POST['description'];
    $subject = $_POST['subject'];
    $winning_student = !empty($_POST['winning_student']) ? (int)$_POST['winning_student'] : null;
    $teacher_id = $_POST['teacher_id'];

    $query = "INSERT INTO public.contests (id_contest,title,date,description,subject,winning_student,teacher_id) VALUES (:id_contest,:title,:date,:description,:subject,:winning_student,:teacher_id)";
    $stmt = $pdo->prepare($query);

    try {
        $stmt->execute([
            'id_contest' => $id_contest,
            'title' => $title,
            'date' => $date,
            'description' => $description,
            'subject' => $subject,
            'winning_student' => $winning_student,
            'teacher_id' => $teacher_id
        ]);
        $_SESSION['success_message'] = "Конкурс успешно добавлен";
        header("Location: list.php");
        exit();
    } catch (PDOException $e) {
        $_SESSION['error_message'] = "Ошибка: " . $e->getMessage();
        header("Location: list.php");
        exit();
    }
}

$stmt_students = $pdo->query("SELECT * FROM public.students");
$students = $stmt_students->fetchAll(PDO::FETCH_ASSOC);
$stmt_teachers = $pdo->query("SELECT * FROM public.teachers");
$teachers = $stmt_teachers->fetchAll(PDO::FETCH_ASSOC);
?>

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Конкурсы</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
<div class="container-fluid p-2" id="upbar" style="position: fixed; background-color: rgba(141, 141, 141, 1); z-index: 2;">       
        <div class="col">
            <div class="row align-items-start">
                <a href="list.php" class="btn" style="z-index: 2;">❮</a>
                <!-- <a class="btn" id="btn-menu">☰</a> -->
                <div class="col px-2 text-center"><h4>Добавить Конкурс</h4></div>
            </div>
        </div>
    </div>
    <div class="container-fluid pt-5">
        <form method="POST" action="">
            <div class="form-group">
            <h2></h2>
        <form method="POST" action="">
            <div class="form-group">
                <label for="id_contest">Код:</label>
                <input type="number" class="form-control" id="id_contest" name="id_contest" min=0 required>
                <label for="title">Название:</label>
                <input type="text" class="form-control" id="title" name="title" required>
                <label for="date">Дата:</label>
                <input type="date" class="form-control" id="date" name="date" min="2023-01-01"  required>
                <label for="description">Описание:</label>
                <input type="text" class="form-control" id="description" name="description" required>
                <label for="subject">Задание:</label>
                <input type="text" class="form-control" id="subject" name="subject" required>
                <label for="winning_student">Победитель:</label>
                <select class="form-control" id="winning_student" name="winning_student">
                    <option value="">Не выбран</option>
                    <?php foreach ($students as $student): ?>
                        <option value="<?php echo htmlspecialchars($student['id_student']); ?>"><?php echo htmlspecialchars($student['name']. ' ' . $student['surname']); ?></option>
                    <?php endforeach; ?>
                </select>
                <?php if ($_SESSION['role'] === 'admin'): ?>
                <label for="teacher_id">Организатор:</label>
                <select class="form-control" id="teacher_id" name="teacher_id" required>
                    <option value="teacher_id">Не указано</option>
                    <<?php foreach ($teachers as $teacher): ?>
                        <option value="<?php echo htmlspecialchars($teacher['id_prep']); ?>"><?php echo htmlspecialchars($teacher['name']. ' ' . $teacher['surname']); ?></option>
                    <?php endforeach; ?>
                <?php else: ?>
                    <input type="hidden" name="teacher_id" value="<?php echo htmlspecialchars($_SESSION['teacher_id']); ?>"> 
                <?php endif; ?>  
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Добавить</button>
        </form>
    </div>
</body>
</html>
```

4. Назначение прав доступа

Роли и привилегии в PostgreSQL:

    Создание ролей:
    sql
    Copy

    CREATE ROLE admin WITH LOGIN PASSWORD 'admin_password';
    CREATE ROLE teacher WITH LOGIN PASSWORD 'teacher_password';
    CREATE ROLE student WITH LOGIN PASSWORD 'student_password';

    Назначение прав администратору:
    sql
    Copy

    GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO admin;
    GRANT USAGE, SELECT ON ALL SEQUENCES IN SCHEMA public TO admin;

    Права для педагогов:
    sql
    Copy

    GRANT SELECT, INSERT, UPDATE ON Contests, Student_Contests TO teacher;
    GRANT SELECT ON Groups, Students TO teacher;

    Права для учащихся:
    sql
    Copy

    GRANT SELECT ON Contests TO student;
    GRANT SELECT ON Students TO student USING (id_student = CURRENT_USER_ID);
    -- (Требуется настройка RLS или фильтрация через интерфейс)

5. **Создание индексов**

Оптимизация частых запросов:

    Индекс для поиска мероприятий по дате:
    sql
    Copy

    CREATE INDEX idx_contests_date ON Contests(date);

    Индекс для ускорения JOIN между Students и Student_Contests:
    sql
    Copy

    CREATE INDEX idx_student_contests_student_id ON Student_Contests(student_id);

    Уникальность логинов:
    sql
    Copy

    CREATE UNIQUE INDEX idx_users_username ON Users(username);

    Поиск педагогов по email:
    sql
    Copy

    CREATE INDEX idx_teachers_email ON Teachers(email);

6. **Разработка стратегии резервного копирования**

План резервного копирования:

    Ежедневные логические бэкапы:
    bash
    Copy

    pg_dump -U admin -d creative_school -F c -b -v -f /backups/daily/creative_school_$(date +\%Y\%m\%d).backup

    Еженедельные полные бэкапы:
    bash
    Copy

    pg_basebackup -U admin -D /backups/weekly/base_$(date +\%Y\%m\%d) -Ft -z -P

    Восстановление из бэкапа:
    bash
    Copy

    pg_restore -U admin -d creative_school /backups/daily/creative_school_20231001.backup

    Автоматизация через cron:
    cron
    Copy

    0 2 * * * pg_dump -U admin -d creative_school -F c -f /backups/daily/creative_school_$(date +\%Y\%m\%d).backup
    0 3 * * 0 pg_basebackup -U admin -D /backups/weekly/base_$(date +\%Y\%m\%d) -Ft -z -P

    Проверка целостности бэкапов:
    bash
    Copy

    pg_restore --list /backups/daily/creative_school_20231001.backup

Итог

Реализация включает:

    Полноценную схему БД с ограничениями целостности.

    Примеры запросов для CRUD-операций.

    Веб-интерфейс на PHP с ролевой моделью.

    Настройку прав доступа и индексов для оптимизации.

    Надёжную стратегию резервного копирования.

Система готова к внедрению в работу школы детского творчества.

<a id="literature">Список использованных источников</a>

    PostgreSQL 14. Официальная документация. – URL: https://www.postgresql.org/docs/14/index.html

    PHP: Рекомендации по безопасной работе с БД. – URL: https://www.php.net/manual/ru/security.database.sql-injection.php

    ГОСТ Р ИСО/МЭК 12207-2020. Процессы жизненного цикла программных средств.


